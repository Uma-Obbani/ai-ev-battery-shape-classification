Project Overview

This project implements an end-to-end deep learning system to classify EV battery shapes into three categories:

Cylindrical

Pouch

Prismatic

To study background bias and model robustness, two independent models are trained and deployed:

Image-based classifier (full images)

Cutout-based classifier (background removed using segmentation masks)

The system supports:

Offline training & evaluation

Experiment tracking with Weights & Biases

Production-style inference using FastAPI

Interactive UI using Streamlit

Side-by-side comparison of image vs cutout predictions

ğŸ§  Key Objectives

Compare image vs cutout classification performance

Analyze background bias

Deploy a real-time inference API

Provide an interactive user interface

Build a portfolio-ready ML system
ai-ev-battery-shape-classification/
â”‚
â”œâ”€â”€ data/
â”‚   â””â”€â”€ processed/
â”‚       â”œâ”€â”€ train/
â”‚       â”‚   â”œâ”€â”€ images/
â”‚       â”‚   â”œâ”€â”€ masks/
â”‚       â”‚   â””â”€â”€ cutouts/
â”‚       â”œâ”€â”€ val/
â”‚       â”‚   â”œâ”€â”€ images/
â”‚       â”‚   â”œâ”€â”€ masks/
â”‚       â”‚   â””â”€â”€ cutouts/
â”‚       â””â”€â”€ test/
â”‚           â”œâ”€â”€ images/
â”‚           â”œâ”€â”€ masks/
â”‚           â””â”€â”€ cutouts/
â”‚
â”œâ”€â”€ model/
â”‚   â”œâ”€â”€ best_model_images.pth
â”‚   â””â”€â”€ best_model_cutouts.pth
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app.py          # FastAPI application
â”‚   â”œâ”€â”€ train.py        # Training loop (W&B integrated)
â”‚   â”œâ”€â”€ evaluate.py     # Offline evaluation
â”‚   â”œâ”€â”€ predict.py      # CLI prediction utility
â”‚   â”œâ”€â”€ dataset.py      # Dataset & DataLoader logic
â”‚   â”œâ”€â”€ model.py        # ResNet18 architecture
â”‚   â””â”€â”€ __init__.py
â”‚
â”œâ”€â”€ streamlit_app.py    # Streamlit frontend
â”œâ”€â”€ README.md
â””â”€â”€ requirements.txt

ğŸ“Š Dataset

Input: RGB battery images

Annotations: Binary segmentation masks

Classes: Cylindrical, Pouch, Prismatic

Splits: Train / Validation / Test

Cutouts Creation

Cutouts are generated by applying binary masks to images, removing background pixels while preserving the battery shape.

ğŸ—ï¸ Model Architecture

Backbone: ResNet-18

Loss: CrossEntropyLoss

Optimizer: Adam

Input Size: 224 Ã— 224

Normalization: ImageNet statistics

Two models are trained independently:

best_model_images.pth

best_model_cutouts.pth

ğŸš€ Training
export INPUT_TYPE=images
python -m src.train

export INPUT_TYPE=cutouts
python -m src.train

Logged Metrics (via Weights & Biases)

Training loss & accuracy

Validation loss & accuracy

Confusion matrix

Class-wise precision, recall, F1-score

ğŸ“ˆ Evaluation
export INPUT_TYPE=images
python -m src.evaluate

export INPUT_TYPE=cutouts
python -m src.evaluate

Evaluation outputs:

Confusion matrix

Classification report

Validation accuracy

This confirms that offline evaluation behavior matches deployed inference behavior.

export INPUT_TYPE=cutouts
python -m src.predict

Used for:

Local testing

Model sanity checks

Confidence inspection

ğŸŒ FastAPI Inference API

python -m uvicorn src.app:app --reload

Available Endpoints
Endpoint	Description
/predict/image	Image-based model
/predict/cutout	Cutout-based model
/predict/both	Side-by-side comparison

{
  "image_model": {
    "predicted_class": "prismatic",
    "confidence": 0.82
  },
  "cutout_model": {
    "predicted_class": "pouch",
    "confidence": 0.97
  },
  "note": "Models disagree â€“ possible background bias"
}







